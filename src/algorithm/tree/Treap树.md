## Treap树

Treap树是一个合成词，把Tree和Heap各取一半组合而成，Treap是树和堆的结合。

二叉搜索树的每个结点有一个键值，除此之外，Treap树为每个结点人为添加一个被称为优先级的权值。对于键值来说，这棵树是排序二叉树；对于优先级来说，这棵树是一个堆。堆的特征是：在这棵树的任意子树上，根结点的优先级最大。

Treap树的重要性质：令每个结点的优先级互不相等，那么整棵树的形态是唯一的，和元素的插入顺序没有关系。

如果每个结点的优先级进行随机赋值，那么生成的Treap树的形态也是随机的。这虽然不能保证每次生成的Treap树一定是平衡的，但是期望的插入、删除、查找的时间复杂度都是`O(logn)`的。

把新结点`node`插入到Treap树的过程有以下两步：

1. 用朴素的插入方法把`node`按键值的大小插入到合适的子树上。
2. 给`node`随机分配一个优先级，如果node的优先级违反了堆的性质，即它的优先级比父节点高，那么让node往上走，替代父节点，最后得到一个新的Treap树。调整使用的技巧是旋转，包括左旋和右旋，其示意图如下。

<p align="center">
  <img width="100%" height="100%" src="/assets/Algorithms/Tree_rotation.png">
</p>

Treap树的删除有两种情况。如果待删除的节点`x`是叶子结点，直接删除。如果待删除的节点`x`有两个子结点，那么找到优先级最大的子结点，把`x`向相反的方向旋转，也就是把`x`向树的下层调整，直到`x`被旋转到叶子结点，然后直接删除。